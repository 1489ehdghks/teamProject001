<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modal</title>
    <link href="{{ url_for('static', filename='editMember.css') }}" rel="stylesheet">
</head>

<body>

    <div class="modal" id="myModal">
        <span class="close-btn" onclick="closeModal()">&times;</span>
        <div class="modal-content">
            <h2>Contents</h2>

            <div class="form-group">
                <label for="InputName">Name</label>
                <input type="text" id="InputName">
            </div>

            <div class="form-group">
                <label for="InputImage_url">Image_URL</label>
                <input type="text" id="InputImage_url">
            </div>

            <div class="form-group">
                <label for="InputMbti">MBTI</label>
                <input type="text" id="InputMbti">
            </div>

            <div class="form-group">
                <label for="InputCol_type">Collaboration_type</label>
                <input type="text" id="InputCol_type">
            </div>

            <div class="form-group">
                <label for="InputAdvantage">Advantage</label>
                <input type="text" id="InputAdvantage">
            </div>

            <div class="form-group">
                <label for="InputBlog_url">Blog_URL</label>
                <input type="text" id="InputBlog_url">
            </div>

            <button class="submit-btn" onclick="closeModal()">Submit</button>
        </div>
    </div>

    <div class="overlay" id="overlay" onclick="closeModal()"></div>

    <script>
        function openModal() {
            document.getElementById('myModal').style.display = 'block';
            document.getElementById('overlay').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('myModal').style.display = 'none';
            document.getElementById('overlay').style.display = 'none';
        }
          function submitMemberData() {
        const memberId = {{ member.id }}; // Flask 템플릿 엔진을 사용해 멤버 ID를 주입합니다.
        const data = {
            name: document.getElementById('InputName').value,
            image_url: document.getElementById('InputImage_url').value,
            mbti: document.getElementById('InputMbti').value,
            collabo_style: document.getElementById('InputCol_type').value,
            advantage: document.getElementById('InputAdvantage').value,
            blog_url: document.getElementById('InputBlog_url').value,
        };

        fetch(`/update_member/${memberId}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                // CSRF 토큰 추가가 필요할 경우 여기에 추가
            },
            body: JSON.stringify(data),
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            }
            throw new Error('Network response was not ok.');
        })
        .then(data => {
            console.log(data.message); // 성공 메시지 로깅
            window.location.href = '/'; // 기존 페이지로 이동
        })
        .catch(error => console.error('Error:', error));
    }

    // 'Submit' 버튼의 이벤트 리스너를 수정합니다.
    document.querySelector('.submit-btn').addEventListener('click', function(event) {
        event.preventDefault(); // 폼 제출 기본 이벤트 방지
        submitMemberData(); // 멤버 데이터 제출 함수 호출
        closeModal(); // 모달 닫기 함수 호출
    });
    </script>

</body>

</html>